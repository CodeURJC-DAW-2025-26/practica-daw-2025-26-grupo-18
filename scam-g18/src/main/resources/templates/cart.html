{{>header}}

        <main class="main">
            <!-- Page Title -->
            <div class="page-title light-background">
                <div class="container">
                    <nav class="breadcrumbs">
                        <ol>
                            <li><a href="/">Inicio</a></li>
                            <li class="current">Carrito</li>
                        </ol>
                    </nav>
                    <h1>Carrito de Compra</h1>
                </div>
            </div>
            <!-- End Page Title -->

            <!-- Cart Section -->
            <section id="cart-section" class="section">
                <div class="container" data-aos="fade-up">
                    <!-- Back Button -->
                    <div class="mb-4">
                        <a href="/" class="btn btn-secondary d-inline-flex align-items-center gap-2" style="background-color: #85613d; border-color: #85613d"> <i class="bi bi-arrow-left"></i> Volver </a>
                    </div>

                    <div class="row">
                        <div class="col-lg-8">
                            <!-- Cart Items -->
                            <div class="card shadow-sm mb-4">
                                <div class="card-header bg-white py-3">
                                    <h5 class="mb-0">Tu Pedido</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle">
                                            <thead class="table-light">
                                                <tr>
                                                    <th scope="col">Producto</th>
                                                    <th scope="col">Cantidad</th>
                                                    <th scope="col" class="text-end">Precio</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {{#order.items}}
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <!-- Placeholder image -->
                                                            <div class="ms-2">
                                                                {{#course}}
                                                                <h6 class="mb-0">{{title}}</h6>
                                                                <small class="text-muted">Curso Online</small>
                                                                {{/course}}
                                                                {{#event}}
                                                                <h6 class="mb-0">{{title}}</h6>
                                                                <small class="text-muted">Evento Presencial</small>
                                                                {{/event}}
                                                                {{#isSubscription}}
                                                                <h6 class="mb-0">Suscripción Premium</h6>
                                                                <small class="text-muted">Acceso Mensual</small>
                                                                {{/isSubscription}}
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        1 <!-- Cantidad fija por ahora para cursos/eventos -->
                                                    </td>
                                                    <td class="text-end">
                                                        {{priceInEuros}}€
                                                    </td>
                                                </tr>
                                                {{/order.items}}
                                                {{^order.items}}
                                                <tr>
                                                    <td colspan="4" class="text-center py-4">Tu carrito está vacío.</td>
                                                </tr>
                                                {{/order.items}}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <!-- Order Summary -->
                            <div class="card shadow-sm">
                                <div class="card-header bg-white py-3">
                                    <h5 class="mb-0">Resumen</h5>
                                </div>
                                <div class="card-body">
                                    <ul class="list-group list-group-flush mb-3">
                                        <li class="list-group-item d-flex justify-content-between border-0 px-0 pb-0">
                                            Subtotal
                                            <span>{{subtotal}}€</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between border-0 px-0">
                                            Impuestos (21%)
                                            <span>{{tax}}€</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between border-0 px-0 mb-3">
                                            <strong>Total</strong>
                                            <strong>{{total}}€</strong>
                                        </li>
                                    </ul>

                                    <!-- Pay Button -->
                                    <div class="d-grid gap-2">
                                        <button
                                            class="btn btn-primary btn-lg"
                                            type="button"
                                            style="background-color: #d96d3c; border-color: #d96d3c"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#paymentForm"
                                            aria-expanded="false"
                                            aria-controls="paymentForm"
                                            {{^order.items}}disabled{{/order.items}}>
                                            Pagar Ahora
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Payment Form Container (Bootstrap Collapse) -->
                            <div class="collapse mt-4" id="paymentForm">
                                <div class="card shadow-sm">
                                    <div class="card-header bg-white py-3">
                                        <h5 class="mb-0">Información de Tarjeta</h5>
                                    </div>
                                    <div class="card-body">
                                        <form action="/cart/checkout" method="post">
                                            <input type="hidden" name="_csrf" value="{{_csrf.token}}" />
                                            <div class="mb-3">
                                                <label for="cardName" class="form-label">Nombre en la tarjeta</label>
                                                <input type="text" class="form-control" id="cardName" name="cardName" required />
                                            </div>
                                            <div class="mb-3">
                                                <label for="billingEmail" class="form-label">Email para factura</label>
                                                <input type="email" class="form-control" id="billingEmail" name="billingEmail" required />
                                            </div>
                                            <div class="mb-3">
                                                <label for="cardNumber" class="form-label">Número de tarjeta</label>
                                                <input type="text" class="form-control" id="cardNumber" name="cardNumber" placeholder="0000 0000 0000 0000" required />
                                            </div>
                                            <div class="row">
                                                <div class="col-6 mb-3">
                                                    <label for="cardExpiry" class="form-label">Caducidad (MM/YY)</label>
                                                    <input type="text" class="form-control" id="cardExpiry" name="cardExpiry" required />
                                                </div>
                                                <div class="col-6 mb-3">
                                                    <label for="cardCvv" class="form-label">CVV</label>
                                                    <input type="password" class="form-control" id="cardCvv" autocomplete="off" required />
                                                </div>
                                            </div>
                                            <div class="d-grid gap-2">
                                                <button type="submit" class="btn btn-success">Confirmar Pago</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        {{>footer}}
    </body>
</html>
