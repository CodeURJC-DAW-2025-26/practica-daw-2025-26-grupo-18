{{>header}}

<main class="main">
    <section class="section">
        <div class="container">
            <div class="row g-0 shadow-lg rounded-4 overflow-hidden" style="min-height: 600px">

                <!-- Imagen Izquierda -->
                <div class="col-lg-6 d-none d-lg-block position-relative">
                    <img src="/img/services/services-3.webp" alt="Completa tu perfil" class="img-fluid w-100 h-100"
                        style="object-fit: cover; object-position: center" />
                    <div class="position-absolute top-0 start-0 w-100 h-100" style="background: rgba(0, 0, 0, 0.3)">
                    </div>
                    <div class="position-absolute bottom-0 start-0 p-5 text-white">
                        <h3 class="fw-bold">¡Casi listo!</h3>
                        <p class="lead">Completa tu perfil para empezar a disfrutar de todo lo que SCAM tiene para ti.</p>
                    </div>
                </div>

                <!-- Formulario Derecha -->
                <div class="col-lg-6 bg-white d-flex align-items-center">
                    <div class="p-5 w-100">

                        <!-- Cabecera con logo de Google -->
                        <div class="text-center mb-4">
                            <div class="d-flex align-items-center justify-content-center gap-2 mb-2">
                                <i class="bi bi-google text-danger fs-4"></i>
                                <h2 class="fw-bold text-dark mb-0">Completa tu registro</h2>
                            </div>
                            <p class="text-muted">Rellena los datos adicionales para crear tu cuenta</p>
                        </div>

                        <!-- Mensaje de error si el username ya existe -->
                        {{#errorMsg}}
                        <div class="alert alert-danger" role="alert">
                            {{errorMsg}}
                        </div>
                        {{/errorMsg}}

                        <form id="googleRegisterForm" action="/register/google" method="post" enctype="multipart/form-data">
                            <input type="hidden" name="_csrf" value="{{_csrf.token}}" />

                            <!-- Correo de Google (solo lectura) -->
                            <div class="mb-3">
                                <label for="googleEmailField" class="form-label small fw-bold">Correo electrónico</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-google text-danger"></i></span>
                                    <input type="email" class="form-control bg-light text-muted" id="googleEmailField"
                                        name="email"
                                        value="{{googleEmail}}" readonly
                                        title="Este correo proviene de tu cuenta de Google y no puede modificarse" />
                                </div>
                                <div class="form-text text-muted">
                                    <i class="bi bi-lock-fill me-1"></i>Vinculado a tu cuenta de Google
                                </div>
                            </div>

                            <!-- Nombre de usuario -->
                            <div class="mb-3">
                                <label for="regUsername" class="form-label small fw-bold">Nombre de usuario</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                                    <input type="text" class="form-control" id="regUsername" name="username"
                                        placeholder="Tu nombre de usuario" value="{{googleSuggestedUsername}}" required />
                                </div>
                            </div>

                            <!-- Contraseña (para poder iniciar sesión también con usuario/contraseña) -->
                            <div class="mb-3">
                                <label for="regPassword" class="form-label small fw-bold">Contraseña</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-lock"></i></span>
                                    <input type="password" class="form-control" id="regPassword" name="password"
                                        placeholder="••••••••" required />
                                </div>
                                <div class="form-text text-muted">Necesaria también para acceso tradicional</div>
                            </div>

                            <!-- Género -->
                            <div class="mb-3">
                                <label for="regGender" class="form-label small fw-bold">Género</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-gender-ambiguous"></i></span>
                                    <select class="form-select" id="regGender" name="gender" required>
                                        <option value="" selected disabled>Selecciona una opción</option>
                                        <option value="MALE">Masculino</option>
                                        <option value="FEMALE">Femenino</option>
                                        <option value="PREFER_NOT_TO_SAY">Prefiero no decirlo</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Fecha de nacimiento -->
                            <div class="mb-3">
                                <label for="regBirthDate" class="form-label small fw-bold">Fecha de nacimiento</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-calendar"></i></span>
                                    <input type="date" class="form-control" id="regBirthDate" name="birthDate" required />
                                </div>
                            </div>

                            <!-- País -->
                            <div class="mb-3">
                                <label for="regCountry" class="form-label small fw-bold">País</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-globe"></i></span>
                                    <input type="text" class="form-control" id="regCountry" name="country"
                                        placeholder="Ej: España" value="{{googleSuggestedCountry}}" required />
                                </div>
                            </div>

                            <!-- Foto de perfil -->
                            <div class="mb-4">
                                <label for="regImage" class="form-label small fw-bold">Foto de perfil <span class="text-muted fw-normal">(opcional)</span></label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-image"></i></span>
                                    <input type="file" class="form-control" id="regImage" name="image"
                                        accept="image/*" />
                                </div>
                                <div class="form-text text-muted">Si no subes ninguna, se usará una imagen por defecto.</div>
                            </div>

                            <!-- Botones: Completar registro y Cancelar -->
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary py-2 fw-bold"
                                    style="background-color: var(--accent-color); border-color: var(--accent-color)">
                                    <i class="bi bi-check-circle me-1"></i>Completar registro
                                </button>
                                <a href="/register/google/cancel" class="btn btn-outline-secondary py-2 fw-bold">
                                    <i class="bi bi-x-circle me-1"></i>Cancelar
                                </a>
                            </div>

                        </form>

                    </div>
                </div>

            </div>
        </div>
    </section>
</main>

{{>footer}}
</body>

</html>
